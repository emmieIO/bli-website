import{u as P,b as d,j as e,H as V,L as C,r as o}from"./app-Bc8u-Egx.js";import{D as U}from"./DashboardLayout-CQvMXsgG.js";import{C as H}from"./ConfirmModal-xCVP65c1.js";import"./Toast-CI2zFTMv.js";import"./user-C8nIR6im.js";function W({course:r}){var v,w;const{sideLinks:S,errors:a}=P().props,[u,y]=d.useState(""),[x,b]=d.useState(""),[p,j]=d.useState(""),[N,k]=d.useState([]),[m,l]=d.useState(!1),[D,g]=d.useState(null),[c,h]=d.useState({title:"",description:""}),[i,n]=d.useState({show:!1,type:null,id:null}),M=t=>{k(s=>s.includes(t)?s.filter(f=>f!==t):[...s,t])},A=t=>{t.preventDefault(),u.trim()&&(l(!0),o.post(route("admin.requirements.store",r.slug),{requirement:u},{preserveScroll:!0,onSuccess:()=>{y("")},onFinish:()=>{l(!1)}}))},q=t=>{n({show:!0,type:"requirement",id:t,title:"Delete Requirement"})},L=()=>{if(!(!i.id||!i.type))switch(l(!0),i.type){case"requirement":o.delete(route("admin.requirements.destroy",[r.slug,i.id]),{preserveScroll:!0,onFinish:()=>{l(!1),n({show:!1,type:null,id:null})}});break;case"outcome":o.delete(route("admin.outcomes.destroy",[r.slug,i.id]),{preserveScroll:!0,onFinish:()=>{l(!1),n({show:!1,type:null,id:null})}});break;case"module":o.delete(route("instructor.courses.modules.delete",[r.slug,i.id]),{preserveScroll:!0,onFinish:()=>{l(!1),n({show:!1,type:null,id:null})}});break;case"lesson":i.moduleId&&o.delete(route("instructor.courses.lessons.delete",[r.slug,i.moduleId,i.id]),{preserveScroll:!0,onFinish:()=>{l(!1),n({show:!1,type:null,id:null})}});break}},_=t=>{t.preventDefault(),x.trim()&&(l(!0),o.post(route("admin.outcomes.store",r.slug),{outcome:x},{preserveScroll:!0,onSuccess:()=>{b("")},onFinish:()=>{l(!1)}}))},F=t=>{n({show:!0,type:"outcome",id:t,title:"Delete Learning Outcome"})},T=t=>{t.preventDefault(),p.trim()&&(l(!0),o.post(route("instructor.courses.modules.store",r.slug),{title:p},{preserveScroll:!0,onSuccess:()=>{j("")},onFinish:()=>{l(!1)}}))},E=t=>{g(t.id),h({title:t.title,description:t.description||""})},R=(t,s)=>{t.preventDefault(),c.title.trim()&&(l(!0),o.put(route("instructor.courses.modules.update",[r.slug,s]),{title:c.title,description:c.description},{preserveScroll:!0,onSuccess:()=>{g(null),h({title:"",description:""})},onFinish:()=>{l(!1)}}))},I=(t,s)=>{n({show:!0,type:"module",id:t,title:`Delete Module: ${s}`})},O=t=>{o.visit(route("instructor.courses.lessons.create",[r.slug,t]))},$=(t,s,f)=>{n({show:!0,type:"lesson",id:s,moduleId:t,title:`Delete Lesson: ${f}`})},B=t=>{switch(t){case"video":return"ðŸŽ¥";case"pdf":return"ðŸ“„";case"link":return"ðŸ”—";default:return"ðŸ“"}};return e.jsxs(U,{sideLinks:S,children:[e.jsx(V,{title:`Course Builder - ${r.title}`}),e.jsxs("div",{className:"px-4 md:px-6 py-6",children:[e.jsxs("div",{className:"mb-8 p-6 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:r.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Level:"})," ",r.level||"Beginner"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Category:"})," ",((v=r.category)==null?void 0:v.name)||"Uncategorized"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Instructor:"})," ",((w=r.instructor)==null?void 0:w.name)||"N/A"]}),r.thumbnail_path&&e.jsx("div",{children:e.jsx("img",{src:`/storage/${r.thumbnail_path}`,alt:"Thumbnail",className:"h-24 w-24 object-cover rounded mt-2"})})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(C,{href:route("instructor.courses.index"),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 focus:ring-4 focus:ring-gray-200",children:"â† Back to Courses"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-5 self-start",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Course Requirements"}),e.jsx("ul",{className:"space-y-2 mb-4",children:r.requirements&&r.requirements.length>0?r.requirements.map(t=>e.jsxs("li",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-gray-700 text-sm",children:t.requirement}),e.jsx("button",{onClick:()=>q(t.id),className:"text-gray-400 text-sm cursor-pointer flex items-center space-x-2 hover:text-red-600",children:e.jsx("i",{className:"fas fa-times w-4 h-4"})})]},t.id)):e.jsx("li",{className:"text-sm text-gray-500 italic",children:"No requirements yet."})}),e.jsxs("form",{onSubmit:A,className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:u,onChange:t=>y(t.target.value),placeholder:"Add new requirement",className:"flex-1 rounded-lg border focus:ring-2 focus:ring-primary border-primary p-2 text-sm text-gray-900"}),e.jsx("button",{type:"submit",disabled:m||!u.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-primary hover:bg-primary-600 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add"})]}),(a==null?void 0:a.requirement)&&e.jsx("span",{className:"text-red-600 text-xs mt-1 block",children:a.requirement})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-5 self-start",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Learning Outcomes"}),e.jsx("ul",{className:"space-y-2 mb-4",children:r.outcomes&&r.outcomes.length>0?r.outcomes.map(t=>e.jsxs("li",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-gray-700 text-sm",children:t.outcome}),e.jsx("button",{onClick:()=>F(t.id),className:"text-gray-400 text-sm cursor-pointer flex items-center space-x-2 hover:text-red-600",children:e.jsx("i",{className:"fas fa-times w-4 h-4"})})]},t.id)):e.jsx("li",{className:"text-sm text-gray-500 italic",children:"No outcomes yet."})}),e.jsxs("form",{onSubmit:_,className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:x,onChange:t=>b(t.target.value),placeholder:"Add learning outcome",className:"flex-1 rounded-lg border focus:ring-2 focus:ring-primary border-primary p-2 text-sm text-gray-900"}),e.jsx("button",{type:"submit",disabled:m||!x.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-primary hover:bg-primary-600 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add"})]}),(a==null?void 0:a.outcome)&&e.jsx("span",{className:"text-red-600 text-xs mt-1 block",children:a.outcome})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("form",{onSubmit:T,className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-3 sm:space-y-0",children:[e.jsx("input",{type:"text",value:p,onChange:t=>j(t.target.value),placeholder:"New Module Title",className:"w-full sm:w-auto flex-1 rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-primary focus:ring-primary"}),e.jsx("button",{type:"submit",disabled:m||!p.trim(),className:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-primary rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add Module"})]}),(a==null?void 0:a.title)&&e.jsx("small",{className:"mt-2 text-xs text-red-500 block",children:a.title})]}),e.jsx("div",{className:"space-y-6",children:r.modules&&r.modules.length>0?r.modules.map(t=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[D===t.id?e.jsxs("form",{onSubmit:s=>R(s,t.id),className:"p-4 border-b",children:[e.jsx("input",{type:"text",value:c.title,onChange:s=>h({...c,title:s.target.value}),className:"w-full mb-2 rounded-lg border border-gray-300 p-2 text-sm",placeholder:"Module Title"}),e.jsx("textarea",{value:c.description,onChange:s=>h({...c,description:s.target.value}),className:"w-full mb-2 rounded-lg border border-gray-300 p-2 text-sm",placeholder:"Module Description (optional)",rows:2}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",disabled:m,className:"px-3 py-1.5 text-sm bg-primary text-white rounded-lg disabled:opacity-50",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>g(null),className:"px-3 py-1.5 text-sm bg-gray-200 text-gray-700 rounded-lg",children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>M(t.id),children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex space-x-2",onClick:s=>s.stopPropagation(),children:[e.jsxs("button",{onClick:()=>O(t.id),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-primary cursor-pointer hover:bg-primary-50 rounded-lg",title:"Add Lesson",children:[e.jsx("i",{className:"fas fa-plus mr-1"})," Add Lesson"]}),e.jsx("button",{onClick:()=>E(t),className:"inline-flex items-center px-2 py-1.5 text-sm text-gray-600 hover:text-blue-600",title:"Edit Module",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>I(t.id,t.title),className:"inline-flex items-center px-2 py-1.5 text-sm text-gray-600 hover:text-red-600",title:"Delete Module",children:e.jsx("i",{className:"fas fa-trash"})})]}),N.includes(t.id)?e.jsx("i",{className:"fas fa-chevron-up w-5 h-5 text-gray-500"}):e.jsx("i",{className:"fas fa-chevron-down w-5 h-5 text-gray-500"})]})]}),N.includes(t.id)&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx("ul",{className:"space-y-2",children:t.lessons&&t.lessons.length>0?t.lessons.map(s=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm text-gray-700 font-medium",children:[B(s.type)," ",s.type.charAt(0).toUpperCase()+s.type.slice(1),": ",s.title]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.type==="video"&&s.content_path&&e.jsx("a",{href:`/storage/${s.content_path}`,className:"text-green-600 hover:text-green-800 text-sm",children:"View"}),s.type==="pdf"&&s.content_path&&e.jsx("a",{href:`/storage/${s.content_path}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary hover:underline text-sm",title:"View PDF",children:e.jsx("i",{className:"fas fa-file-pdf w-4 h-4"})}),s.type==="link"&&s.content_path&&e.jsx("a",{href:s.content_path,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary hover:underline text-sm",children:e.jsx("i",{className:"fas fa-external-link-alt w-4 h-4"})}),e.jsx(C,{href:route("instructor.courses.lessons.edit",[r.slug,t.id,s.id]),className:"inline-flex items-center text-blue-600 hover:text-blue-800 transition-colors",title:"Edit Lesson",children:e.jsx("i",{className:"fas fa-edit w-4 h-4"})}),e.jsx("button",{onClick:()=>$(t.id,s.id,s.title),className:"inline-flex items-center text-red-600 hover:text-red-800 transition-colors",title:"Delete Lesson",children:e.jsx("i",{className:"fas fa-trash w-4 h-4"})})]})]},s.id)):e.jsx("li",{className:"text-sm text-gray-500 italic",children:'No lessons yet. Click "Add Lesson" to get started.'})})})]},t.id)):e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6 text-center text-gray-500",children:"No modules yet. Add your first module above."})})]}),e.jsx(H,{show:i.show,onClose:()=>n({show:!1,type:null,id:null}),onConfirm:L,title:i.title||"Confirm Delete",message:i.type==="module"?"Are you sure you want to delete this module? All lessons in this module will be deleted, including any video lessons which will be permanently removed from Vimeo. This action cannot be undone.":i.type==="lesson"?"Are you sure you want to delete this lesson? If this is a video lesson, the video will also be removed from Vimeo. This action cannot be undone.":"Are you sure you want to delete this item? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmButtonClass:"bg-red-600 hover:bg-red-700 text-white",icon:e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:e.jsx("i",{className:"fas fa-trash text-red-600 text-xl"})}),isProcessing:m,processingText:"Deleting..."})]})}export{W as default};
